<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cadastro Funcionários</title>
  <style>
    /* Estilos permanecem os mesmos */
  </style>
</head>
<body>

<div class="container">
  <h2>Cadastro Funcionários</h2>
  <form id="cadastroFuncionarioForm">
    <label for="nome">Nome</label>
    <input type="text" id="nome" name="nome" required>

    <label for="dataNasc">Data de Nascimento</label>
    <input type="date" id="dataNasc" name="dataNasc" required>

    <div class="file-input">
      <label for="fotoPerfil">Foto de Perfil</label>
      <input type="file" id="fotoPerfil" name="fotoPerfil" accept="image/*">
    </div>

    <label for="nomeEmpresa">Nome da Empresa</label>
    <input type="text" id="nomeEmpresa" name="nomeEmpresa">

    <div class="file-input">
      <label for="logoEmpresa">Logo da Empresa</label>
      <input type="file" id="logoEmpresa" name="logoEmpresa" accept="image/*">
    </div>

    <label for="cadastro">Cadastro</label>
    <input type="text" id="cadastro" name="cadastro" required>

    <label for="senha">Senha</label>
    <input type="password" id="senha" name="senha" required>

    <label for="confirmarSenha">Confirmar Senha</label>
    <input type="password" id="confirmarSenha" name="confirmarSenha" required>

    <label for="email">Email</label>
    <input type="email" id="email" name="email" required>

    <button type="submit" class="btn-finalizar">Finalizar</button>
  </form>
</div>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-analytics.js";
  import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

  // Sua configuração do Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyBk3kzqpBKEyrwHdnC_RgHmd4PDUJOqoEU",
    authDomain: "copinfo-5a0f5.firebaseapp.com",
    databaseURL: "https://copinfo-5a0f5-default-rtdb.firebaseio.com",
    projectId: "copinfo-5a0f5",
    storageBucket: "copinfo-5a0f5.appspot.com",
    messagingSenderId: "543026869888",
    appId: "1:543026869888:web:f2ef1ce629b2bf49615865",
    measurementId: "G-9JHXYXYKGT"
  };

  // Inicializa o Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const auth = getAuth();
  const db = getFirestore();

  // Simule a autenticação do administrador (substitua pelo seu método real)
  const adminUser = auth.currentUser; // Obtenha o usuário autenticado (administrador)

  document.getElementById('cadastroFuncionarioForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    const nome = document.getElementById('nome').value;
    const dataNasc = document.getElementById('dataNasc').value;
    const nomeEmpresa = document.getElementById('nomeEmpresa').value;
    const cadastro = document.getElementById('cadastro').value;
    const senha = document.getElementById('senha').value;
    const email = document.getElementById('email').value;

    // Verifica se a senha e a confirmação de senha são iguais
    const confirmarSenha = document.getElementById('confirmarSenha').value;
    if (senha !== confirmarSenha) {
      alert("As senhas não coincidem!");
      return;
    }

    try {
      // Cria um novo usuário
      const userCredential = await createUserWithEmailAndPassword(auth, email, senha);
      
      // Adiciona dados do funcionário ao Firestore
      await addDoc(collection(db, 'funcionarios'), {
        uid: userCredential.user.uid,
        nome,
        dataNasc,
        nomeEmpresa,
        cadastro,
        email,
        fotoPerfil: '', // URL da foto
        logoEmpresa: '', // URL do logo
        adminId: adminUser ? adminUser.uid : null // Armazena o ID do administrador
      });

      alert("Funcionário cadastrado com sucesso!");
      // Limpa o formulário
      document.getElementById('cadastroFuncionarioForm').reset();
    } catch (error) {
      console.error("Erro ao cadastrar: ", error);
      alert("Erro ao cadastrar funcionário: " + error.message);
    }
  });
</script>

</body>
</html>
